<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新年贺卡</title>
    <script src="https://cdn.tailwindcss.com"></script> 
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .firework {
            position: absolute;
            width: 3px;
            height: 3px;
            border-radius: 50%;
            background: white;
            pointer-events: none;
        }

        .spark {
            position: absolute;
            width: 2px;
            height: 2px;
            border-radius: 50%;
            background: white;
            opacity: 0;
            animation: spark 1.5s ease-out forwards;
        }

        @keyframes spark {
            0% { transform: scale(0); opacity: 1; }
            10% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }

        @keyframes rise {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-200px); opacity: 0; }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center h-screen bg-gradient-to-b from-red-200 to-yellow-200">
    <div class="relative flex flex-col items-center justify-center rounded-2xl backdrop-blur-sm p-8" style="box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);">
        <div class="text-6xl symbol hover:scale-110 cursor-pointer" onclick="launchFirework()">🎉</div>
        <p class="mt-2">点击爆竹送祝福</p>
        <div id="card" class="hidden rounded-2xl backdrop-blur-sm p-8 text-center">
            <h1 class="symbol text-4xl font-bold">金蛇献瑞</h1>
            <p class="symbol text-2xl mt-4">亲爱的Amy</p>
            <p class="symbol text-lg mt-2">祝你新的一年更加热爱自己</p>
            <p class="symbol text-lg mt-2">愿你在蛇年里灵动优雅，前程似锦！</p>
        </div>
    </div>

    <canvas id="fireworks"></canvas>

    <script>
        const canvas = document.getElementById('fireworks');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const fireworks = [];
        const particles = [];

        function Firework() {
            this.x = Math.random() * canvas.width;
            this.y = canvas.height;
            this.speed = Math.random() * 3 + 2;
            this.angle = Math.PI / 2;
            this.color = `hsl(${Math.random() * 360}, 100%, 50%)`;
            this.brightness = Math.random() * 30 + 70;
            this.width = 2;
            this.height = 2;
            this.exploded = false;
        }

        Firework.prototype.update = function() {
            if (!this.exploded) {
                this.y -= this.speed;
                if (this.y < canvas.height / 2) {
                    this.explode();
                }
            } else {
                for (let i = 0; i < this.particles.length; i++) {
                    this.particles[i].update();
                }
            }
        };

        Firework.prototype.draw = function() {
            if (!this.exploded) {
                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(this.x, this.y + this.height);
                ctx.lineWidth = this.width;
                ctx.strokeStyle = `hsla(${this.color}, ${this.brightness}%)`;
                ctx.stroke();
            } else {
                for (let i = 0; i < this.particles.length; i++) {
                    this.particles[i].draw();
                }
            }
        };

        Firework.prototype.explode = function() {
            this.exploded = true;
            const numParticles = Math.random() * 300 + 200; // 增加粒子数量
            for (let i = 0; i < numParticles; i++) {
                const particle = new Particle(this.x, this.y, this.color);
                this.particles.push(particle);
            }
        };

        function Particle(x, y, color) {
            this.x = x;
            this.y = y;
            this.color = color;
            this.speed = Math.random() * 5 + 1;
            this.angle = Math.random() * Math.PI * 2;
            this.width = Math.random() * 2 + 1; // 减小粒子大小
            this.height = Math.random() * 2 + 1;
            this.alpha = 1;
            this.friction = 0.95; // 增加摩擦力以减缓速度
            this.gravity = 0.05;
            this.tail = []; // 添加尾迹数组
        }

        Particle.prototype.update = function() {
            this.speed *= this.friction;
            this.x += Math.cos(this.angle) * this.speed;
            this.y += Math.sin(this.angle) * this.speed + this.gravity;
            this.alpha -= 0.02; // 减少透明度以模拟消失效果
            this.tail.push({ x: this.x, y: this.y, alpha: this.alpha }); // 添加当前位置到尾迹数组
            if (this.tail.length > 5) { // 限制尾迹长度
                this.tail.shift();
            }
        };

        Particle.prototype.draw = function() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.width, 0, Math.PI * 2);
            ctx.fillStyle = `hsla(${this.color}, ${this.alpha})`;
            ctx.fill();

            // 绘制尾迹
            for (let i = 0; i < this.tail.length; i++) {
                ctx.beginPath();
                ctx.arc(this.tail[i].x, this.tail[i].y, this.width, 0, Math.PI * 2);
                ctx.fillStyle = `hsla(${this.color}, ${this.tail[i].alpha})`;
                ctx.fill();
            }
        };

        function createFirework() {
            const firework = new Firework();
            fireworks.push(firework);
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            for (let i = fireworks.length - 1; i >= 0; i--) {
                fireworks[i].update();
                fireworks[i].draw();
                if (fireworks[i].particles.length === 0 && fireworks[i].exploded) {
                    fireworks.splice(i, 1);
                }
            }

            requestAnimationFrame(animate);
        }

        setInterval(createFirework, 1000);
        animate();

        function launchFirework() {
            createFirework();
        }

        function createSparks(x, y){
            for(let i=0;i<100;i++){
                const spark = document.createElement('div');
                spark.className = 'spark';
                spark.style.left = x + 'px';
                spark.style.top = y + 'px';
                spark.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
                document.body.appendChild(spark);
                setTimeout(() => {
                    spark.remove();
                }, 1000);
            }
        }
    </script>
</body>
</html>
